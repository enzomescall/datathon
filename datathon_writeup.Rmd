---
title: "Datathon Writeup"
author: "Linda Cao, Georgie Stammer, Enzo Moraes Mescall, Erik Mendes Novak"
date: "`r Sys.Date()`"
output: 
  pdf_document: 
    fig_height: 4
    fig_width: 6
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(warning = FALSE, 
                      message = FALSE, 
                      fig.align = "center")
```

```{r load-packages, echo = F, include = FALSE}
library(tidyverse)
library(knitr)
library(broom)
library(patchwork)
library(haven)
library(yardstick)
```

```{r load-data, include= FALSE}
Wave1_data <- read_sav("Wave1_20170906.sav")
Wave1_data$index <- 1:nrow(Wave1_data)

predictors <- select(Wave1_data, c(country, level3,
                                   se002:se012a, se014:pgnum, index))
```

```{r clean-data, include= FALSE}
ideology_responses <- Wave1_data %>%
  select(index, q121:q148)

# This is our janky method of removing responses which failed to answer more
# than 4 questions
ideology_responses[is.na(ideology_responses)] <- 100000000

na_sum <- ideology_responses %>%
  mutate(sum = rowSums(ideology_responses[])) %>%
  filter(sum <499999999)

na_sum[na_sum > 100000] <- NA

na_sum$avg <- rowMeans(subset(na_sum, select = c(q121:q148)), na.rm = TRUE)

average_ideology <- select(na_sum, c(index, avg))

clean_data <- inner_join(average_ideology, predictors, by = "index")
```

```{r organise-clean-data, include= FALSE}
final_data <- clean_data %>%
  mutate(country = as.factor(country)) %>%
  mutate(urban_rural = as.factor(level3 - 1)) %>%
  mutate(gender = as.factor(se002 - 1)) %>%
  mutate(age = se003a) %>%
  mutate(marital_status = as.factor(se004a - 1)) %>%
  mutate(education = se005a) %>%
  mutate(household_members = se008a) %>%
  mutate(household_generations = se008b) %>%
  mutate(subjective_status = se017) %>%
  mutate(religion = case_when(se006 == 11 ~ 0, se006 < 11 ~ 1))

levels(final_data$country) <- c("Japan", "Hong Kong", "Korea", "China",
                          "Mongolia", "Philippines", "Taiwan", "Thailand")
```

#### Introduction

Our group was interested in section P of the questionnaire where individuals were asked a series of political questions and responded with their opinions. The data set provides information about the material conditions, and their perceived material conditions, of the surveyed and thus allows us to attempt to estimate the impact of an individual's material conditions on their political leanings. Notably, all the questions in section P are on a scale of 1 - 4 where answering 1 indicates support of a larger authoritarian government while answering 4.

## Research Question

To what extent do an individual's material conditions affect their leanings toward authoritarian form of government?


#### Methodology

To measure an individual's political leanings based off of their answers from the questionnaire we took their responses from questions q121 to q148 which scale from 1 to 4 and took the arithmetic mean across all questions.

#### Exploratory Data Analysis

```{r}
ggplot(data = final_data, aes(x = avg)) +
  geom_histogram(fill = "lightblue", color = "black", bins = 40) +
  labs(title = "Distribution of Political Leanings Index",
       x = "Political Leaning Index Value",
       y = "Count")
```

The distribution is unimodal, looks normal and doesn't have any apparent outliers.

#### Data Analysis

#### Conclusion